<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cadastro - Barbearia Davi Dias</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #fff;
    max-width: 400px;
    margin: 2rem auto;
    padding: 1rem;
  }
  h1 {
    color: #e6b800;
    text-align: center;
  }
  form {
    background: #222;
    padding: 1.5rem;
    border-radius: 8px;
  }
  label {
    display: block;
    margin-top: 1rem;
  }
  input[type="text"], input[type="email"], input[type="password"] {
    width: 100%;
    padding: 0.6rem;
    margin-top: 0.3rem;
    border-radius: 4px;
    border: none;
    font-size: 1rem;
  }
  button {
    margin-top: 1.5rem;
    width: 100%;
    background: #e6b800;
    color: black;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    padding: 0.8rem;
  }
  .link {
    margin-top: 1rem;
    text-align: center;
  }
  .link a {
    color: #e6b800;
    font-weight: bold;
    text-decoration: none;
  }
  #msg {
    margin-top: 1rem;
    text-align: center;
  }
</style>
</head>
<body>

<h1>Cadastro</h1>

<form id="cadastro-form">
  <label for="nome">Nome Completo:</label>
  <input type="text" id="nome" placeholder="Seu nome" required />

  <label for="email">Email:</label>
  <input type="email" id="email" placeholder="seuemail@exemplo.com" required />

  <label for="senha">Senha (mínimo 6 caracteres):</label>
  <input type="password" id="senha" placeholder="Sua senha" required minlength="6" />

  <button type="submit">Cadastrar</button>
</form>

<div class="link">
  <p>Já tem cadastro? <a href="login.html">Faça login aqui</a></p>
</div>

<div id="msg"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import {
    getAuth,
    createUserWithEmailAndPassword,
    updateProfile,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDx2IBIdo7_b0P9tMWhkxAvM0ehBa9cYas",
    authDomain: "testgithub-d13a2.firebaseapp.com",
    databaseURL: "https://testgithub-d13a2-default-rtdb.firebaseio.com",
    projectId: "testgithub-d13a2",
    storageBucket: "testgithub-d13a2.appspot.com",
    messagingSenderId: "847448063225",
    appId: "1:847448063225:web:1f51f702060de265f6898e"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();

  const form = document.getElementById("cadastro-form");
  const msgDiv = document.getElementById("msg");

  form.addEventListener("submit", e => {
    e.preventDefault();

    const nome = document.getElementById("nome").value.trim();
    const email = document.getElementById("email").value.trim();
    const senha = document.getElementById("senha").value;

    msgDiv.textContent = "";

    createUserWithEmailAndPassword(auth, email, senha)
      .then(userCredential => {
        // Atualiza o displayName com o nome
        return updateProfile(userCredential.user, {
          displayName: nome
        });
      })
      .then(() => {
        alert("Cadastro realizado com sucesso!");
        window.location.href = "index.html";
      })
      .catch(error => {
        msgDiv.style.color = "#f88";
        msgDiv.textContent = "Erro no cadastro: " + error.message;
      });
  });

  // Se já estiver logado, vai direto para index
  onAuthStateChanged(auth, user => {
    if (user) {
      window.location.href = "index.html";
    }
  });
</script>

</body>
</html>
